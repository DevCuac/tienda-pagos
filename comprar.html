<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Comprar Membresía</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" type="image/png" href="favicon.png">
  <link rel="stylesheet" href="style.css">
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700&display=swap" rel="stylesheet">
  <style>
    body {
      background: linear-gradient(120deg, #181b22 0%, #23242b 100%);
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
    }
    .form-box {
      background: rgba(28,30,38,0.95);
      padding: 36px 22px 30px 22px;
      border-radius: 19px;
      display: inline-block;
      margin: 70px auto 24px auto;
      max-width: 415px;
      box-shadow: 0 6px 30px #18181b44;
      text-align: center;
    }
    .summary {
      margin-bottom: 19px;
      font-size: 1.18em;
      color: #ededed;
      letter-spacing: .2px;
    }
    .summary .m-name {
      font-weight: bold;
      color: #fafafa;
      font-size: 1.1em;
      letter-spacing: 1.1px;
    }
    .summary .m-price {
      color: #f0d479;
      font-weight: bold;
    }
    .benefits-checkout {
      background: rgba(40,41,46,0.90);
      color: #dfdfdf;
      font-size: 0.99em;
      padding: 10px 11px 7px 15px;
      margin: 14px 0 18px 0;
      border-radius: 11px;
      box-shadow: 0 1px 7px #19191a11;
      text-align: left;
      min-height: 68px;
    }
    .benefits-checkout ul { margin: 0; padding: 0; list-style: none; }
    .benefits-checkout li { margin-bottom: 6px; padding-left: 14px; position: relative; }
    .benefits-checkout li:before {
      content: "✓";
      color: #bfbfbf;
      font-weight: bold;
      position: absolute;
      left: 0;
    }
    label { display:block; margin:16px 0 7px; color:#ededed;}
    input[type="text"], input[type="email"] {
      padding:10px; border-radius:7px; border:none; width:93%; margin-bottom:12px; font-size:1em;
      background: #25262b; color: #fafafa; outline: none; box-shadow:0 2px 8px #1a1a1a14;
    }
    input[type="text"]:focus, input[type="email"]:focus {
      border:1.5px solid #f0d479; background:#232329;
    }
    .cert-check {
      color: #b1b1b1; background: #22232b;
      padding: 7px 0; margin: 19px 0 8px 0; border-radius: 8px;
      font-size: 1.01em; text-align: center;
    }
    /* Botones de pago */
    .payment-buttons {
      display: flex;
      flex-direction: column;
      gap: 12px;
      margin: 20px 0 2px 0;
    }
    .pay-btn {
      font-family: 'Montserrat', Arial, sans-serif;
      font-size: 1.08em;
      font-weight: 700;
      color: #fff;
      background: #22242d;
      border: none;
      border-radius: 11px;
      padding: 10px 12px 10px 16px;
      text-align: left;
      cursor: pointer;
      transition: background .18s, box-shadow .17s, transform .18s;
      display: flex;
      align-items: center;
      box-shadow: 0 2px 9px #18181b0b;
      letter-spacing: .3px;
      outline: none;
    }
    .pay-btn.paypal { background: linear-gradient(100deg,#0a3571 60%,#1270db 100%); }
    .pay-btn.yape { background: #6300f7; }
    .pay-btn.binance { background: #121212; border: 1.2px solid #f3ba2f; color: #f3ba2f;}
    .pay-btn.mercadopago { background: #00b4e3;}
    .pay-btn:hover { box-shadow:0 6px 15px #0002; transform: translateY(-2px) scale(1.04);}
    .pay-btn.paypal:hover { background: linear-gradient(100deg,#1270db 30%,#0a3571 100%);}
    .pay-btn.yape:hover { background: #7e34fa;}
    .pay-btn.binance:hover { background: #181818; color: #fff;}
    .pay-btn.mercadopago:hover { background: #38c6f9;}
    #paypal-button-container { margin-top: 18px; }
    /* Loader animado */
    .loader {
      width: 54px; height: 54px;
      margin: 25px auto 0 auto;
      position: relative;
      display: none;
    }
    .loader .spin {
      width: 54px; height: 54px;
      border: 5px solid #f0d47930;
      border-top: 5px solid #f0d479;
      border-radius: 50%;
      position: absolute;
      left: 0; top: 0;
      animation: spin 0.7s linear infinite;
    }
    .loader .pulse {
      width: 42px; height: 42px;
      border-radius: 50%;
      background: #f0d4792a;
      position: absolute;
      left: 6px; top: 6px;
      animation: pulse 1.5s infinite cubic-bezier(.22,1.16,.61,.91);
    }
    @keyframes spin { 100% { transform: rotate(360deg);} }
    @keyframes pulse {
      0% { opacity: 0.45; transform: scale(1);}
      50% { opacity: 0.17; transform: scale(1.11);}
      100% { opacity: 0.45; transform: scale(1);}
    }
    @media (max-width:600px){.form-box{width:99vw;}}
  </style>
</head>
<body>
  <div class="form-box">
    <a href="index.html" style="text-decoration:none;"><img src="favicon.png" width="38" style="margin-bottom:13px; border-radius:9px;"></a>
    <h2 style="color:#fafafa;">Comprar Membresía</h2>
    <div class="summary">
      Membresía: <span id="membresia-summary" class="m-name"></span><br>
      Precio: <span id="precio-summary" class="m-price"></span> USD
    </div>
    <div class="benefits-checkout" id="beneficios-checkout"></div>
    <form id="dataForm" onsubmit="return false;">
      <label for="discord">Usuario de Discord *</label>
      <input type="text" id="discord" required placeholder="ej: Angel#1234">
      <label for="email">Correo electrónico *</label>
      <input type="email" id="email" required placeholder="Tu correo">
    </form>
    <div class="cert-check">&#128274; Pago seguro con Paypal</div>
    <!-- BOTONES DE PAGO -->
    <div class="payment-buttons">
      <button id="btn-paypal" class="pay-btn paypal">
        <img src="/paypal.svg" width="22" style="vertical-align:middle;margin-right:7px;">
        Pagar con Paypal
      </button>
      <button class="pay-btn yape" onclick="gotoWhatsapp('Yape')">
        <img src="/yape.svg" width="22" style="vertical-align:middle;margin-right:7px;">
        Yape Perú
      </button>
      <button class="pay-btn binance" onclick="gotoWhatsapp('Binance')">
        <img src="/binance.svg" width="22" style="vertical-align:middle;margin-right:7px;">
        Binance (USDT/ARS)
      </button>
      <button class="pay-btn mercadopago" onclick="gotoWhatsapp('MercadoPago')">
        <img src="/mercadopago.svg" width="26" style="vertical-align:middle;margin-right:7px;">
        Mercado Pago
      </button>
    </div>
    <div id="paypal-button-container"></div>
    <div class="loader" id="loader">
      <div class="spin"></div>
      <div class="pulse"></div>
    </div>
  </div>

  <!-- Paypal SDK Live -->
  <script src="https://www.paypal.com/sdk/js?client-id=ASuRVnsN90v9apMr8qppSHihfkuRI7uykgHKa27VwYIXp-Q_BnS3aC-mFR2cR2yLu_EUCrsRCsh745KB&currency=USD"></script>
  <script>
    // 1. Datos de membresía desde la URL
    const params = new URLSearchParams(window.location.search);
    const membresia = params.get('membresia') || 'Nacido del Caos';
    const precio = params.get('precio') || '8';
    document.getElementById('membresia-summary').textContent = membresia;
    document.getElementById('precio-summary').textContent = precio;

    // 2. Resumen de beneficios dinámico
    const beneficios = {
      "Nacido del Caos": [
        "Rol exclusivo Discord",
        "Acceso premium a canales y sorteos",
        "Beneficios digitales básicos"
      ],
      "Heraldo del Caos": [
        "Rol VIP Discord",
        "Más beneficios exclusivos",
        "Recompensas diarias mejoradas"
      ],
      "Dios del Caos": [
        "Rol supremo Discord",
        "Todos los beneficios VIP + ultra",
        "Acceso a sorteos y eventos legendarios"
      ]
    };
    let lista = beneficios[membresia] || beneficios["Nacido del Caos"];
    let html = "<ul>";
    lista.forEach(b=>html+=`<li>${b}</li>`);
    html += "</ul>";
    document.getElementById("beneficios-checkout").innerHTML = html;

    // BOTÓN PAYPAL
    document.getElementById('btn-paypal').onclick = function() {
      document.getElementById('paypal-button-container').innerHTML = "";
      paypal.Buttons({
        createOrder: function(data, actions) {
          var discord = document.getElementById('discord').value.trim();
          var email = document.getElementById('email').value.trim();
          if (!discord || !email) {
            alert('Completa todos los campos antes de pagar.');
            return false;
          }
          document.getElementById("loader").style.display = "block";
          return actions.order.create({
            purchase_units: [{
              amount: { value: precio, currency_code: "USD" },
              description: `Membresía ${membresia}`,
              custom_id: `${discord}|${membresia}|${email}`
            }]
          });
        },
        onApprove: function(data, actions) {
          document.getElementById("loader").style.display = "block";
          return actions.order.capture().then(function(details) {
            document.getElementById("loader").style.display = "none";
            alert('¡Pago realizado! Te contactaremos por Discord o email para activar tu membresía.');
            window.location.href = "success.html";
          });
        },
        onCancel: function(data) {
          document.getElementById("loader").style.display = "none";
          window.location.href = "cancel.html";
        }
      }).render('#paypal-button-container');
    };

    // Otros métodos
    function gotoWhatsapp(metodo) {
      const discord = document.getElementById('discord').value.trim();
      const email = document.getElementById('email').value.trim();
      let mensaje = encodeURIComponent(
        `Hola, quiero comprar la membresía "${membresia}" (${precio} USD) y deseo pagar por ${metodo}. Mi Discord: ${discord} - Email: ${email}`
      );
      window.open(`https://wa.me/51994970590?text=${mensaje}`, '_blank');
    }
    window.gotoWhatsapp = gotoWhatsapp;
  </script>
</body>
</html>
